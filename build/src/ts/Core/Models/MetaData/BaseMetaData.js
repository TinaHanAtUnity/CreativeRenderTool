import { Model } from 'Core/Models/Model';
import { MetaData } from 'Core/Utilities/MetaData';
export class BaseMetaData extends Model {
    constructor(name, schema) {
        super(name, schema);
    }
    getCategory() {
        return this.get('category');
    }
    getKeys() {
        return this.get('keys');
    }
    fetch(core, keys) {
        let finalKeys = [];
        if (!keys) {
            finalKeys = this.getKeys();
        }
        else {
            finalKeys = keys;
        }
        return this.getValues(core, finalKeys).then((data) => {
            return this.setValues(data);
        });
    }
    setValues(data) {
        let success = false;
        for (const key in data) {
            if (data.hasOwnProperty(key)) {
                try {
                    this.set(key, data[key]);
                }
                catch (e) {
                    return false;
                }
                success = true;
            }
        }
        return success;
    }
    getValues(core, keys) {
        const returnObject = {};
        const metaData = new MetaData(core);
        return metaData.hasCategory(this.getCategory()).then(exists => {
            if (!exists) {
                return Promise.resolve([]);
            }
            return Promise.all(keys.map((key) => metaData.get(this.getCategory() + '.' + key, false).then(([found, value]) => {
                if (found) {
                    returnObject[key] = value;
                }
            })));
        }).then(() => {
            return returnObject;
        });
    }
}
BaseMetaData.Schema = {
    category: ['string'],
    keys: ['array']
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmFzZU1ldGFEYXRhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3RzL0NvcmUvTW9kZWxzL01ldGFEYXRhL0Jhc2VNZXRhRGF0YS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQVcsS0FBSyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDbkQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBT25ELE1BQU0sT0FBZ0IsWUFBOEMsU0FBUSxLQUFRO0lBTWhGLFlBQVksSUFBWSxFQUFFLE1BQWtCO1FBQ3hDLEtBQUssQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUVNLFdBQVc7UUFDZCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVNLE9BQU87UUFDVixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVNLEtBQUssQ0FBQyxJQUFjLEVBQUUsSUFBZTtRQUN4QyxJQUFJLFNBQVMsR0FBYSxFQUFFLENBQUM7UUFDN0IsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNQLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7U0FDOUI7YUFBTTtZQUNILFNBQVMsR0FBRyxJQUFJLENBQUM7U0FDcEI7UUFFRCxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1lBQ2pELE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFUyxTQUFTLENBQUMsSUFBZ0M7UUFDaEQsSUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxFQUFFO1lBQ3BCLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDMUIsSUFBSTtvQkFDQSxJQUFJLENBQUMsR0FBRyxDQUFVLEdBQUcsRUFBYyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztpQkFDakQ7Z0JBQUMsT0FBTyxDQUFDLEVBQUU7b0JBQ1IsT0FBTyxLQUFLLENBQUM7aUJBQ2hCO2dCQUVELE9BQU8sR0FBRyxJQUFJLENBQUM7YUFDbEI7U0FDSjtRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFFTyxTQUFTLENBQUMsSUFBYyxFQUFFLElBQWM7UUFDNUMsTUFBTSxZQUFZLEdBQStCLEVBQUUsQ0FBQztRQUNwRCxNQUFNLFFBQVEsR0FBYSxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM5QyxPQUFPLFFBQVEsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQzFELElBQUksQ0FBQyxNQUFNLEVBQUU7Z0JBQ1QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2FBQzlCO1lBQ0QsT0FBTyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQVUsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEdBQUcsR0FBRyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLEVBQUUsRUFBRTtnQkFDdEgsSUFBSSxLQUFLLEVBQUU7b0JBQ1AsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztpQkFDN0I7WUFDTCxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDVCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQ1QsT0FBTyxZQUFZLENBQUM7UUFDeEIsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDOztBQTlEYSxtQkFBTSxHQUF1QjtJQUN2QyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUM7SUFDcEIsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDO0NBQ2xCLENBQUMifQ==