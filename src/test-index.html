<!DOCTYPE html>
<html lang="en">
<head>
    <title>Unity Ads WebView</title>

    <meta charset="utf-8"/>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="format-detection" content="telephone=no"/>

    <script>
        var origin = 'http://localhost:8000/';
        if(location.search.length > 0 && location.search.indexOf('?') !== -1) {
            var queryString = location.search.split('?')[1].split('&');
            var queryParams = {};
            for(i = 0; i < queryString.length; i++) {
                var param = queryString[i].split('=');
                queryParams[param[0]] = param[1];
            }
            if('origin' in queryParams) {
                var decodedOrigin = decodeURIComponent(queryParams['origin']);
                origin = decodedOrigin.substring(0, decodedOrigin.lastIndexOf('/') + 1);
            }
        }

        var style = document.createElement('link');
        style.rel = 'stylesheet';
        style.href = origin + 'css/main.css';

        var require = {
            baseUrl: origin + 'js',
            deps: ['es6-promise', 'mocha'],
            paths: {
                'es6-promise': origin + 'vendor/es6-promise',
                mocha: origin + 'vendor/mocha',
                chai: origin + 'vendor/chai',
                sinon: origin + 'vendor/sinon',
                text: origin + 'vendor/text',
                reporter: origin + 'vendor/reporter',
                html: origin + 'html',
                xmldom: origin + 'vendor/dom-parser'
            },
            shim: {
                mocha: {
                    deps: ['reporter'],
                    init: function(reporter) {
                        this.mocha.setup({
                            ui: 'bdd',
                            checkLeaks: true,
                            fullTrace: true,
                            globals: ['nativebridge', 'webviewbridge'],
                            reporter: reporter
                        });
                        this.mocha.suite.emit('pre-require', window, null, this.mocha);
                        return this.mocha;
                    }
                }
            },
            config: {
                text: {
                    useXhr: function () {
                        return true;
                    }
                }
            }
        };

        var requirejs = document.createElement('script');
        requirejs.src = origin + 'vendor/require.js';
        requirejs.setAttribute('data-main', origin + 'runner.js');

        document.head.appendChild(style);
        document.head.appendChild(requirejs);
    </script>
</head>
<body></body>
</html>
