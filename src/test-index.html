<!DOCTYPE html>
<html lang="en">
<head>
  <title>Unity Ads WebView</title>

  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="format-detection" content="telephone=no" />

  <script>
    var queryString = location.search.split('?')[1].split('&');
    var queryParams = {};

    for(i = 0; i < queryString.length; i++) {
      var param = queryString[i].split('=');
      queryParams[param[0]] = param[1];
    }

    var origin;
    if(queryParams['origin']) {
      origin = queryParams['origin'].substring(0, queryParams['origin'].lastIndexOf('/') + 1);
    } else {
      origin = 'http://localhost:8000/';
    }

    var require = {
      baseUrl: origin + 'src/ts/',
      deps: ['es6-promise', 'mocha'],
      paths: {
        'src/ts': '../../src/ts',
        test: '../../test',
        'es6-promise': '../../vendor/es6-promise',
        mocha: '../../vendor/mocha',
        chai: '../../vendor/chai',
        sinon: '../../vendor/sinon',
        text: '../../vendor/text',
        reporter: '../../vendor/reporter',
        html: '../../html'
      },
      shim: {
        mocha: {
          deps: ['reporter'],
          init: function(reporter) {
            this.mocha.setup({
              ui: 'bdd',
              checkLeaks: true,
              fullTrace: true,
              globals: ['nativebridge', 'webviewbridge'],
              reporter: reporter
            });
            this.mocha.suite.emit('pre-require', window, null, this.mocha);
            return this.mocha;
          }
        }
      },
      config: {
        text: {
          useXhr: function () {
            return true;
          }
        }
      }
    };

    document.addEventListener('DOMContentLoaded', function() {
      var requirejs = document.createElement('script');
      requirejs.src = origin + 'vendor/require.js';
      requirejs.setAttribute('data-main', origin + 'runner.js');

      var style = document.createElement('link');
      style.rel = 'stylesheet';
      style.href = origin + 'css/main.css';

      var head = document.getElementsByTagName('head')[0];
      head.appendChild(style);
      head.appendChild(requirejs);
    }, false);
  </script>
</head>
<body></body>
</html>
