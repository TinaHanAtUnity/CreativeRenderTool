<script>
function getQueryParams(e) {
  var d = document.createElement("a");
  d.href = e;
  e = {};
  if (d.search) {
    d = d.search.substring(1).split(/&/);
    for (var g = 0; g < d.length; g++) {
      var h = d[g].split(/=/), k = h[0];
      h = h[1];
      e[k] ? e[k].push(h) : e[k] = [h];
    }
  }
  return e;
}
function isObjectEmpty(e) {
  for (var d in e) {
    if (e.hasOwnProperty(d)) {
      return !1;
    }
  }
  return !0;
}
(function() {
  window.addEventListener("pageshow", function() {
    AFMA_ReceiveMessage("onshow");
  });
  var e, d, g, h = 0, k = 0, m = 0, n = 0, l;
  document.addEventListener("touchstart", function(b) {
    g = Date.now();
    e = b.touches[0];
    k++;
  });
  document.addEventListener("touchend", function(b) {
    l = Date.now() - g;
    d = b.changedTouches[0];
    h++;
  });
  document.addEventListener("touchmove", function(b) {
    m++;
  });
  document.addEventListener("touchcancel", function(b) {
    n++;
  });
  window.unity = window.unity || {};
  window.unity.afma = new function() {
    var b = this;
    this.intentCallbacks = {};
    this.intentCallbackId = 0;
    this.sentQuartiles = {};
    var g = [];
    document.addEventListener("DOMContentLoaded", function() {
      var a = document.querySelector("video");
      null === a ? b.postMessage("tracking", {event:"error", data:JSON.stringify("videoEl for admob is not found")}) : (a.addEventListener("error", function() {
        b.postMessage("tracking", {event:"error", data:JSON.stringify(a.error)});
      }), a.addEventListener("timeupdate", function() {
        var c = Math.floor(a.currentTime / a.duration * 4);
        if (0 !== c && !(c in b.sentQuartiles)) {
          b.sentQuartiles[c] = !0;
          switch(c) {
            case 1:
              var f = "firstQuartile";
              break;
            case 2:
              f = "midpoint";
              break;
            case 3:
              f = "thirdQuartile";
          }
          f && b.postMessage("tracking", {event:f});
        }
      }), a.addEventListener("stalled", function() {
        b.postMessage("tracking", {event:"stalled"});
      }), a.addEventListener("canplay", function() {
        b.postMessage("tracking", {event:"loaded"});
      }));
    });
    this.forceOrientation = function(a, c, f) {
      this.postMessage("forceOrientation", {orientation:a, override:c, animationDuration:f});
    };
    this.click = function(a) {
      var c = b.getTouchInfo();
      this.postMessage("click", {url:a, touch:c});
    };
    this.getClickSignals = function(a) {
      return null;
    };
    this.appendClickSignals = function(a, c) {
      return a;
    };
    this.getClickSignalsAsync = function(a) {
      return new Promise(function(a, f) {
        b.requestClickSignal(a);
      });
    };
    this.appendClickSignalsAsync = function(a, c) {
      return (c ? Promise.resolve(c) : this.getClickSignalsAsync(a)).then(function(c) {
        var b = c.encodedClickSignal, f = getQueryParams(a);
        f.ms || (a = isObjectEmpty(f) ? a + "?ms=" + b : a + "&ms=" + b);
        return a = a + "&rvdt=" + c.rvdt;
      });
    };
    this.requestClickSignal = function(a) {
      g.push(a);
      a = this.getTouchInfo();
      this.postMessage("getClickSignal", a);
    };
    this.getTouchInfo = function() {
      var a = {counts:{up:h, down:k, move:m, cancel:n}};
      e && (a.start = {x:e.clientX || 0.0, y:e.clientY || 0.0});
      d && (a.end = {x:d.clientX || 0.0, y:d.clientY || 0.0}, a.diameter = 2 * d.radiusX, a.pressure = d.force || 0.0);
      l && (a.duration = l);
      return a;
    };
    this.onReceiveClickSignal = function(a) {
      for (var c = 0, b = g.length; c < b; c++) {
        g[c](a);
      }
      g = [];
    };
    this.notifyRewardedVideoStart = function() {
      this.postMessage("rewardedVideoStart");
    };
    this.grantReward = function() {
      this.postMessage("grantReward");
    };
    this.close = function(a) {
      this.postMessage("close");
    };
    this.disableBackButton = function(a) {
      this.postMessage("disableBackButton", {disabled:a});
    };
    this.openIntent = function(a, c, b) {
      this.postMessage("openIntent", {url:a, action:c, mimeType:b});
      return !1;
    };
    this.openIntentExtended = function(a) {
      return this.openIntent(a.url, a.action, a.mimeType);
    };
    this.openUrl = function(a) {
      this.postMessage("openUrl", {url:a});
    };
    this.openDeepLinkUrl = function(a, c, b, d) {
      this.postMessage("openUrl", {url:a});
      c();
    };
    this.openBrowser = function(a) {
      this.postMessage("openUrl", {url:a});
    };
    this.openNativeApp = function(a) {
      this.postMessage("openUrl", {url:a});
    };
    this.openSystemBrowser = function(a, c) {
      this.postMessage("openUrl", {url:a});
    };
    this.openStoreOverlay = function(a) {
      this.postMessage("openStoreOverlay", {url:a});
    };
    this.openInAppStore = function(a, c, b) {
      this.postMessage("openInAppStore", {productId:a, url:c});
    };
    this.fetchAppStoreOverlay = function(a) {
      this.postMessage("fetchAppStoreOverlay", {productId:a});
    };
    this.canOpenUrls = function(a, c, b, d) {
      b = {};
      if (a.length) {
        for (d = 0; d < a.length; d++) {
          b[a[d]] = !0;
        }
      } else {
        b[a] = !0;
      }
      c("openableURLs", b);
    };
    this.canOpenIntents = function(a, c, d, e) {
      var f = b.intentCallbackId++;
      b.intentCallbacks[f] = {callback:c, timer:setTimeout(function() {
        d();
        delete b.intentCallbacks[f];
      }, e)};
      this.postMessage("openableIntents", {id:f, intents:a});
    };
    this.postMessage = function(a, b) {
      window.parent.postMessage({type:"afma", event:a, data:b}, "*");
    };
    this.handleOpenableIntentResponse = function(a) {
      var c = a.id;
      a = a.results;
      if (c in b.intentCallbacks) {
        var d = b.intentCallbacks[c].callback;
        d("openableIntents", a);
        clearTimeout(b.intentCallbacks[c].timer);
        delete b.intentCallbacks[c];
      }
    };
    this.setOrienationProperties = function(a) {
      window.mraid.setOrienationProperties(a);
    };
    this.useCustomClose = function(a) {
    };
    window.addEventListener("message", function(a) {
      "afma" === a.data.type && ("back" === a.data.event ? (console.log("calling AFMA back function", a), AFMA_ReceiveMessage("onbackblocked")) : "openableIntentsResponse" === a.data.event ? b.handleOpenableIntentResponse(a.data.data) : "clickSignal" === a.data.event && (console.log("recieved click signal", a), b.onReceiveClickSignal(a.data.data)));
    });
  };
})();

</script>
