<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <script>
        /*Copyright (c) 2011-2016 Moat Inc. All Rights Reserved.*/
        function initMoatTracking(c, d, e, k, l) {
            var g = document.createElement("script"), a = [];
            d = {
                adData: {ids: d, duration: e, url: l}, dispatchEvent: function(b) {
                    this.sendEvent ? (a && (a.push(b), b = a, a = !1), this.sendEvent(b)) : a.push(b)
                }
            };
            e = "_moatApi" + Math.floor(1E8 * Math.random());
            var f, h;
            try {
                f = c.ownerDocument, h = f.defaultView || f.parentWindow
            } catch(b) {
                f = document, h = window
            }
            h[e] = d;
            g.type = "text/javascript";
            c && c.insertBefore(g, c.childNodes[0] || null);
            g.src = "https://z.moatads.com/" + k + "/moatvideo.js#" + e;
            return d
        }

        var moat = undefined;
        document.addEventListener('DOMContentLoaded', function() {
            window.addEventListener('message', function(event) {
                if(event && event.data && event.data.type && event.data.data) {
                    switch(event.data.type) {
                        case 'init':
                            var dummyElement = document.createElement('div');
                            document.body.appendChild(dummyElement);
                            console.log('init: ' + event.data.data.ids + ' duration: ' + event.data.data.duration + ' url: ' + event.data.data.url);
                            moat = initMoatTracking(dummyElement, event.data.data.ids, event.data.data.duration, "unityinappvideo254672075459", event.data.data.url);
                            break;

                        case 'event':
                            console.log('type: ' + event.data.data.type + ' volume: ' + event.data.data.volume);
                            if(moat) {
                                moat.dispatchEvent({
                                    "type": event.data.data.type,
                                    "adVolume": event.data.data.volume
                                });
                            }
                            break;

                        default:
                            break;
                    }
                }
            }, false);

        });
    </script>
</head>
<body>
</body>
</html>
